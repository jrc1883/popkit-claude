{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Security Audit Report",
  "description": "Schema for validating security vulnerability assessments",
  "strict": true,
  "type": "object",
  "required": [
    "auditDate",
    "scope",
    "securityScore",
    "recommendation"
  ],
  "properties": {
    "projectName": {
      "type": "string",
      "description": "Name of the project being audited"
    },
    "auditDate": {
      "type": "string",
      "format": "date",
      "description": "Date of the audit (YYYY-MM-DD)"
    },
    "auditor": {
      "type": "string",
      "default": "security-auditor",
      "description": "Agent that performed the audit"
    },
    "scope": {
      "type": "string",
      "description": "Scope of the audit (Full codebase, Module, Feature, PR)"
    },
    "securityScore": {
      "type": "integer",
      "minimum": 0,
      "maximum": 100,
      "description": "Overall security score (0-100)"
    },
    "vulnerabilitySummary": {
      "type": "object",
      "properties": {
        "critical": { "type": "integer", "minimum": 0 },
        "high": { "type": "integer", "minimum": 0 },
        "medium": { "type": "integer", "minimum": 0 },
        "low": { "type": "integer", "minimum": 0 },
        "info": { "type": "integer", "minimum": 0 }
      }
    },
    "recommendation": {
      "type": "string",
      "enum": ["Pass", "Pass with conditions", "Fail - remediation required"],
      "description": "Overall audit recommendation"
    },
    "vulnerabilities": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "title", "severity"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^VULN-\\d+$"
          },
          "title": { "type": "string" },
          "severity": {
            "type": "string",
            "enum": ["Critical", "High", "Medium", "Low", "Info"]
          },
          "cvssScore": {
            "type": "number",
            "minimum": 0,
            "maximum": 10
          },
          "cwe": { "type": "string" },
          "owasp": { "type": "string" },
          "location": {
            "type": "object",
            "properties": {
              "file": { "type": "string" },
              "lines": { "type": "string" },
              "function": { "type": "string" }
            }
          },
          "description": { "type": "string" },
          "impact": {
            "type": "array",
            "items": { "type": "string" }
          },
          "remediation": { "type": "string" },
          "verificationCommand": { "type": "string" }
        }
      }
    },
    "securityChecklist": {
      "type": "object",
      "properties": {
        "authentication": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "item": { "type": "string" },
              "status": { "type": "boolean" }
            }
          }
        },
        "authorization": {
          "type": "array",
          "items": { "type": "object" }
        },
        "inputValidation": {
          "type": "array",
          "items": { "type": "object" }
        },
        "dataProtection": {
          "type": "array",
          "items": { "type": "object" }
        },
        "dependencies": {
          "type": "array",
          "items": { "type": "object" }
        }
      }
    },
    "dependencyVulnerabilities": {
      "type": "object",
      "properties": {
        "critical": { "type": "integer" },
        "high": { "type": "integer" },
        "moderate": { "type": "integer" },
        "packages": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "complianceCheck": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "standard": { "type": "string" },
          "status": {
            "type": "string",
            "enum": ["Pass", "Fail", "N/A"]
          },
          "notes": { "type": "string" }
        }
      }
    },
    "remediationPriority": {
      "type": "object",
      "properties": {
        "immediate": {
          "type": "array",
          "items": { "type": "string" }
        },
        "thisSprint": {
          "type": "array",
          "items": { "type": "string" }
        },
        "backlog": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "auditConfidence": {
      "type": "integer",
      "minimum": 0,
      "maximum": 100
    },
    "nextAuditRecommended": {
      "type": "string",
      "description": "When the next audit should occur"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "projectName": "User API Endpoints",
      "auditDate": "2025-01-28",
      "auditor": "security-auditor",
      "scope": "src/api/users/",
      "securityScore": 65,
      "vulnerabilitySummary": {
        "critical": 1,
        "high": 2,
        "medium": 3,
        "low": 2,
        "info": 0
      },
      "recommendation": "Fail - remediation required",
      "vulnerabilities": [
        {
          "id": "VULN-001",
          "title": "SQL Injection in User Search",
          "severity": "Critical",
          "cvssScore": 9.8,
          "cwe": "CWE-89",
          "owasp": "A03:2021 Injection"
        }
      ],
      "auditConfidence": 90,
      "nextAuditRecommended": "After remediation complete"
    }
  ]
}
