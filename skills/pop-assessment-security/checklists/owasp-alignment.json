{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "name": "owasp-alignment",
  "version": "1.0.0",
  "description": "OWASP Top 10 2021 alignment checklist for security assessment",
  "owasp_categories": [
    {
      "id": "A01:2021",
      "name": "Broken Access Control",
      "description": "Failures related to access control enforcement",
      "weight": 15,
      "cwe_mappings": ["CWE-22", "CWE-23", "CWE-35", "CWE-59", "CWE-200", "CWE-201", "CWE-219", "CWE-264", "CWE-275", "CWE-276", "CWE-284", "CWE-285", "CWE-352", "CWE-359", "CWE-377", "CWE-402", "CWE-425", "CWE-441", "CWE-497", "CWE-538", "CWE-540", "CWE-548", "CWE-552", "CWE-566", "CWE-601", "CWE-639", "CWE-651", "CWE-668", "CWE-706", "CWE-862", "CWE-863", "CWE-913", "CWE-922", "CWE-1275"],
      "checks": [
        {
          "id": "OWASP-A01-001",
          "name": "Path Traversal Prevention",
          "standard_ref": "AC-003",
          "check_pattern": "IP-005"
        },
        {
          "id": "OWASP-A01-002",
          "name": "Authorization Checks",
          "standard_ref": "AC-002",
          "description": "Verify authorization before resource access"
        }
      ]
    },
    {
      "id": "A02:2021",
      "name": "Cryptographic Failures",
      "description": "Failures related to cryptography and data protection",
      "weight": 15,
      "cwe_mappings": ["CWE-259", "CWE-261", "CWE-296", "CWE-310", "CWE-319", "CWE-321", "CWE-322", "CWE-323", "CWE-324", "CWE-325", "CWE-326", "CWE-327", "CWE-328", "CWE-329", "CWE-330", "CWE-331", "CWE-335", "CWE-336", "CWE-337", "CWE-338", "CWE-339", "CWE-340", "CWE-347", "CWE-523", "CWE-720", "CWE-757", "CWE-759", "CWE-760", "CWE-780", "CWE-798", "CWE-916"],
      "checks": [
        {
          "id": "OWASP-A02-001",
          "name": "No Hardcoded Credentials",
          "standard_ref": "SD-001 through SD-010",
          "check_patterns": ["SD-001", "SD-002", "SD-003", "SD-004", "SD-005", "SD-006", "SD-007", "SD-008", "SD-009", "SD-010"]
        },
        {
          "id": "OWASP-A02-002",
          "name": "No Embedded Private Keys",
          "standard_ref": "SD-005",
          "check_pattern": "SD-005"
        }
      ]
    },
    {
      "id": "A03:2021",
      "name": "Injection",
      "description": "Injection flaws like SQL, NoSQL, OS command injection",
      "weight": 15,
      "cwe_mappings": ["CWE-20", "CWE-74", "CWE-75", "CWE-77", "CWE-78", "CWE-79", "CWE-80", "CWE-83", "CWE-87", "CWE-88", "CWE-89", "CWE-90", "CWE-91", "CWE-93", "CWE-94", "CWE-95", "CWE-96", "CWE-97", "CWE-98", "CWE-99", "CWE-100", "CWE-113", "CWE-116", "CWE-138", "CWE-184", "CWE-470", "CWE-471", "CWE-564", "CWE-610", "CWE-643", "CWE-644", "CWE-652", "CWE-917"],
      "checks": [
        {
          "id": "OWASP-A03-001",
          "name": "Command Injection Prevention",
          "standard_ref": "IP-001, IP-002",
          "check_patterns": ["IP-001", "IP-002"]
        },
        {
          "id": "OWASP-A03-002",
          "name": "Code Injection Prevention",
          "standard_ref": "IP-003, IP-004, IP-007",
          "check_patterns": ["IP-003", "IP-004", "IP-007"]
        },
        {
          "id": "OWASP-A03-003",
          "name": "SQL Injection Prevention",
          "standard_ref": "IP-006",
          "check_pattern": "IP-006"
        }
      ]
    },
    {
      "id": "A04:2021",
      "name": "Insecure Design",
      "description": "Design and architectural flaws",
      "weight": 10,
      "cwe_mappings": ["CWE-73", "CWE-183", "CWE-209", "CWE-213", "CWE-235", "CWE-256", "CWE-257", "CWE-266", "CWE-269", "CWE-280", "CWE-311", "CWE-312", "CWE-313", "CWE-316", "CWE-419", "CWE-430", "CWE-434", "CWE-444", "CWE-451", "CWE-472", "CWE-501", "CWE-522", "CWE-525", "CWE-539", "CWE-579", "CWE-598", "CWE-602", "CWE-642", "CWE-646", "CWE-650", "CWE-653", "CWE-656", "CWE-657", "CWE-799", "CWE-807", "CWE-840", "CWE-841", "CWE-927", "CWE-1021", "CWE-1173"],
      "checks": [
        {
          "id": "OWASP-A04-001",
          "name": "Secure by Default",
          "description": "Security controls enabled by default"
        }
      ]
    },
    {
      "id": "A05:2021",
      "name": "Security Misconfiguration",
      "description": "Insecure default configurations",
      "weight": 10,
      "cwe_mappings": ["CWE-2", "CWE-11", "CWE-13", "CWE-15", "CWE-16", "CWE-260", "CWE-315", "CWE-520", "CWE-526", "CWE-537", "CWE-541", "CWE-547", "CWE-611", "CWE-614", "CWE-756", "CWE-776", "CWE-942", "CWE-1004", "CWE-1032", "CWE-1174"],
      "checks": [
        {
          "id": "OWASP-A05-001",
          "name": "CORS Configuration",
          "standard_ref": "AC-006",
          "description": "Restrictive CORS settings"
        }
      ]
    },
    {
      "id": "A06:2021",
      "name": "Vulnerable and Outdated Components",
      "description": "Using components with known vulnerabilities",
      "weight": 10,
      "cwe_mappings": ["CWE-1035", "CWE-1104"],
      "checks": [
        {
          "id": "OWASP-A06-001",
          "name": "Dependency Scanning",
          "description": "Check for known vulnerabilities in dependencies"
        }
      ]
    },
    {
      "id": "A07:2021",
      "name": "Identification and Authentication Failures",
      "description": "Authentication-related failures",
      "weight": 10,
      "cwe_mappings": ["CWE-255", "CWE-259", "CWE-287", "CWE-288", "CWE-290", "CWE-294", "CWE-295", "CWE-297", "CWE-300", "CWE-302", "CWE-304", "CWE-306", "CWE-307", "CWE-346", "CWE-384", "CWE-521", "CWE-613", "CWE-620", "CWE-640", "CWE-798", "CWE-940", "CWE-1216"],
      "checks": [
        {
          "id": "OWASP-A07-001",
          "name": "Session Management",
          "standard_ref": "AC-005",
          "description": "Secure session configuration"
        }
      ]
    },
    {
      "id": "A08:2021",
      "name": "Software and Data Integrity Failures",
      "description": "Integrity violations in software and data",
      "weight": 10,
      "cwe_mappings": ["CWE-345", "CWE-353", "CWE-426", "CWE-494", "CWE-502", "CWE-565", "CWE-784", "CWE-829", "CWE-830", "CWE-915"],
      "checks": [
        {
          "id": "OWASP-A08-001",
          "name": "Safe Deserialization",
          "standard_ref": "IP-008",
          "check_pattern": "IP-008"
        }
      ]
    },
    {
      "id": "A09:2021",
      "name": "Security Logging and Monitoring Failures",
      "description": "Insufficient logging and monitoring",
      "weight": 5,
      "cwe_mappings": ["CWE-117", "CWE-223", "CWE-532", "CWE-778"],
      "checks": [
        {
          "id": "OWASP-A09-001",
          "name": "Security Event Logging",
          "description": "Log security-relevant events"
        }
      ]
    },
    {
      "id": "A10:2021",
      "name": "Server-Side Request Forgery (SSRF)",
      "description": "SSRF vulnerabilities",
      "weight": 5,
      "cwe_mappings": ["CWE-918"],
      "checks": [
        {
          "id": "OWASP-A10-001",
          "name": "URL Validation",
          "description": "Validate and restrict outbound URLs"
        }
      ]
    }
  ],
  "risk_scoring": {
    "method": "weighted_sum",
    "weights": {
      "A01:2021": 15,
      "A02:2021": 15,
      "A03:2021": 15,
      "A04:2021": 10,
      "A05:2021": 10,
      "A06:2021": 10,
      "A07:2021": 10,
      "A08:2021": 10,
      "A09:2021": 5,
      "A10:2021": 5
    }
  },
  "references": {
    "owasp_top_10": "https://owasp.org/Top10/",
    "cwe_top_25": "https://cwe.mitre.org/top25/archive/2023/2023_top25_list.html"
  }
}
