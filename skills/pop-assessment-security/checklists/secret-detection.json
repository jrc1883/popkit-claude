{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "name": "secret-detection",
  "version": "1.0.0",
  "description": "Machine-readable checklist for secret and credential detection",
  "categories": [
    {
      "id": "api-keys",
      "name": "API Key Detection",
      "weight": 40,
      "checks": [
        {
          "id": "SD-001",
          "name": "API Key Pattern",
          "description": "Detect hardcoded API keys",
          "type": "regex_match",
          "pattern": "(?i)(api[_-]?key|apikey)\\s*[:=]\\s*['\"][a-zA-Z0-9_-]{20,}['\"]",
          "exclude_patterns": ["your[_-]?api[_-]?key", "example", "placeholder"],
          "severity": "critical",
          "cwe": "CWE-798",
          "deduction": 25
        },
        {
          "id": "SD-002",
          "name": "AWS Access Key ID",
          "description": "Detect AWS access key IDs (AKIA*, ABIA*, etc.)",
          "type": "regex_match",
          "pattern": "(?i)(AKIA|ABIA|ACCA|ASIA)[A-Z0-9]{16}",
          "severity": "critical",
          "cwe": "CWE-798",
          "deduction": 25
        },
        {
          "id": "SD-003",
          "name": "AWS Secret Access Key",
          "description": "Detect AWS secret access keys",
          "type": "regex_match",
          "pattern": "(?i)aws[_-]?secret[_-]?access[_-]?key\\s*[:=]\\s*['\"][A-Za-z0-9/+=]{40}['\"]",
          "severity": "critical",
          "cwe": "CWE-798",
          "deduction": 25
        },
        {
          "id": "SD-007",
          "name": "GitHub Token",
          "description": "Detect GitHub personal access tokens",
          "type": "regex_match",
          "pattern": "(gh[pousr]_[A-Za-z0-9_]{36}|github[_-]?token\\s*[:=]\\s*['\"][^'\"]+['\"])",
          "severity": "critical",
          "cwe": "CWE-798",
          "deduction": 25
        }
      ]
    },
    {
      "id": "credentials",
      "name": "Credential Detection",
      "weight": 35,
      "checks": [
        {
          "id": "SD-004",
          "name": "Hardcoded Password",
          "description": "Detect hardcoded password assignments",
          "type": "regex_match",
          "pattern": "(?i)(password|passwd|pwd)\\s*[:=]\\s*['\"][^'\"]{8,}['\"]",
          "exclude_patterns": ["password_hash", "password_field", "placeholder"],
          "severity": "high",
          "cwe": "CWE-259",
          "deduction": 20
        },
        {
          "id": "SD-005",
          "name": "Private Key",
          "description": "Detect embedded private keys",
          "type": "regex_match",
          "pattern": "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----",
          "severity": "critical",
          "cwe": "CWE-321",
          "deduction": 25
        },
        {
          "id": "SD-008",
          "name": "Database Connection String",
          "description": "Detect credentials in connection strings",
          "type": "regex_match",
          "pattern": "(?i)(mongodb|mysql|postgres|redis)://[^\\s'\"]+:[^\\s'\"]+@",
          "severity": "critical",
          "cwe": "CWE-798",
          "deduction": 25
        }
      ]
    },
    {
      "id": "tokens",
      "name": "Token Detection",
      "weight": 25,
      "checks": [
        {
          "id": "SD-006",
          "name": "JWT Token",
          "description": "Detect hardcoded JWT tokens",
          "type": "regex_match",
          "pattern": "eyJ[a-zA-Z0-9_-]*\\.eyJ[a-zA-Z0-9_-]*\\.[a-zA-Z0-9_-]*",
          "severity": "high",
          "cwe": "CWE-798",
          "deduction": 20
        },
        {
          "id": "SD-009",
          "name": "Bearer Token",
          "description": "Detect hardcoded bearer tokens",
          "type": "regex_match",
          "pattern": "(?i)bearer\\s+[a-zA-Z0-9_-]{20,}",
          "severity": "high",
          "cwe": "CWE-798",
          "deduction": 20
        },
        {
          "id": "SD-010",
          "name": "Generic Secret",
          "description": "Detect generic secret patterns",
          "type": "regex_match",
          "pattern": "(?i)(secret|token|credential)[_-]?(key|value)?\\s*[:=]\\s*['\"][a-zA-Z0-9_-]{16,}['\"]",
          "exclude_patterns": ["secret_key_base", "your_secret", "example"],
          "severity": "high",
          "cwe": "CWE-798",
          "deduction": 15
        }
      ]
    }
  ],
  "file_patterns": {
    "include": [
      "**/*.py",
      "**/*.js",
      "**/*.ts",
      "**/*.json",
      "**/*.yml",
      "**/*.yaml",
      "**/*.env*",
      "**/*.config.*"
    ],
    "exclude": [
      "**/node_modules/**",
      "**/.git/**",
      "**/dist/**",
      "**/build/**",
      "**/__pycache__/**",
      "**/test*/**"
    ]
  },
  "scoring": {
    "starting_score": 100,
    "minimum_score": 0,
    "severity_weights": {
      "critical": 25,
      "high": 20,
      "medium": 10,
      "low": 5
    }
  },
  "false_positive_patterns": [
    "your[_-]?api[_-]?key",
    "xxx+",
    "<[^>]+>",
    "\\$\\{[^}]+\\}",
    "example",
    "placeholder",
    "dummy",
    "test",
    "sample",
    "fake"
  ]
}
