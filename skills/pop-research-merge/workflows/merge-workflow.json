{
  "name": "Research Merge Workflow",
  "version": "1.0.0",
  "description": "Guided workflow for merging research from multiple sources",
  "phases": [
    {
      "id": "collect",
      "name": "Collect Sources",
      "description": "Gather research notes to merge",
      "steps": [
        {
          "id": "select_sources",
          "name": "Select Research Sources",
          "prompt": "Which research notes should be merged?",
          "type": "multiselect",
          "data_source": "docs/research/*.md"
        },
        {
          "id": "load_content",
          "name": "Load Content",
          "type": "automated",
          "action": "Read selected research notes"
        },
        {
          "id": "parse_findings",
          "name": "Parse Findings",
          "type": "automated",
          "action": "Extract structured findings from each source"
        }
      ]
    },
    {
      "id": "dedupe",
      "name": "Deduplicate",
      "description": "Identify and handle duplicate findings",
      "steps": [
        {
          "id": "detect_duplicates",
          "name": "Detect Duplicates",
          "type": "automated",
          "script": "scripts/detect_conflicts.py --mode=duplicates"
        },
        {
          "id": "resolve_duplicates",
          "name": "Resolve Duplicates",
          "prompt": "How should duplicates be handled?",
          "type": "selection",
          "options": [
            {"label": "Keep most recent", "value": "recent", "description": "Use the most recent version"},
            {"label": "Keep most detailed", "value": "detailed", "description": "Use the version with more content"},
            {"label": "Merge all", "value": "merge", "description": "Combine information from all versions"},
            {"label": "Manual review", "value": "manual", "description": "Review each duplicate manually"}
          ]
        },
        {
          "id": "detect_conflicts",
          "name": "Detect Conflicts",
          "type": "automated",
          "script": "scripts/detect_conflicts.py --mode=conflicts"
        },
        {
          "id": "resolve_conflicts",
          "name": "Resolve Conflicts",
          "type": "interactive",
          "conditional": "conflicts_found",
          "action": "Present each conflict for user resolution"
        }
      ]
    },
    {
      "id": "synthesize",
      "name": "Synthesize",
      "description": "Combine findings into unified document",
      "steps": [
        {
          "id": "merge_findings",
          "name": "Merge Findings",
          "type": "automated",
          "script": "scripts/merge_findings.py"
        },
        {
          "id": "organize_sections",
          "name": "Organize Sections",
          "prompt": "How should the merged research be organized?",
          "type": "selection",
          "options": [
            {"label": "By topic", "value": "topic", "description": "Group by subject matter"},
            {"label": "By importance", "value": "importance", "description": "Most important findings first"},
            {"label": "Chronological", "value": "chronological", "description": "By discovery date"},
            {"label": "By source", "value": "source", "description": "Preserve original groupings"}
          ]
        },
        {
          "id": "generate_summary",
          "name": "Generate Summary",
          "type": "automated",
          "action": "Create unified summary from merged findings"
        },
        {
          "id": "save_merged",
          "name": "Save Merged Research",
          "type": "automated",
          "action": "Write merged document to docs/research/"
        }
      ]
    }
  ],
  "triggers": {
    "automatic": [],
    "manual": [
      "Invoke pop-research-merge skill",
      "Combine multiple research notes"
    ]
  },
  "output": {
    "primary": "docs/research/YYYY-MM-DD-<topic>-merged.md"
  }
}
