# Husky Pre-commit Hook Configuration
# Generated by PopKit setup-precommit skill

# =============================================================================
# .husky/pre-commit
# =============================================================================

#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged for staged files only
npx lint-staged

# =============================================================================
# .husky/commit-msg
# =============================================================================

#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

{{#COMMITLINT}}
npx --no -- commitlint --edit "$1"
{{/COMMITLINT}}

# =============================================================================
# package.json additions (merge with existing)
# =============================================================================

{
  "scripts": {
    "prepare": "husky"
  },
  "lint-staged": {
    {{#JAVASCRIPT}}
    "*.{js,jsx,ts,tsx}": [
      "eslint --fix",
      "prettier --write"
    ],
    "*.{json,md,css,scss}": [
      "prettier --write"
    ]
    {{/JAVASCRIPT}}
    {{#PYTHON}}
    "*.py": [
      "ruff check --fix",
      "ruff format"
    ]
    {{/PYTHON}}
  },
  "devDependencies": {
    "husky": "^9.0.0",
    "lint-staged": "^15.0.0"
    {{#COMMITLINT}}
    ,"@commitlint/cli": "^19.0.0",
    "@commitlint/config-conventional": "^19.0.0"
    {{/COMMITLINT}}
  }
}

{{#COMMITLINT}}
# =============================================================================
# commitlint.config.js
# =============================================================================

module.exports = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [
      2,
      'always',
      [
        'feat',
        'fix',
        'docs',
        'style',
        'refactor',
        'perf',
        'test',
        'build',
        'ci',
        'chore',
        'revert'
      ]
    ],
    'subject-case': [0],
    'body-max-line-length': [0]
  }
};
{{/COMMITLINT}}

# =============================================================================
# Installation:
#
#   npm install -D husky lint-staged
#   npx husky init
#   # Copy .husky/pre-commit content to .husky/pre-commit
#   # Copy .husky/commit-msg content to .husky/commit-msg (if using commitlint)
#   # Add lint-staged config to package.json
#
# =============================================================================

# Template Variables:
# {{JAVASCRIPT}} - Enable JavaScript/TypeScript lint-staged rules
# {{PYTHON}} - Enable Python lint-staged rules
# {{COMMITLINT}} - Enable conventional commit validation
